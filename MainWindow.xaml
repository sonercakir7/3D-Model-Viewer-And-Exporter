<!-- 3D Model Viewer and Exporter - Soner Ã‡akÄ±r -->
<Window x:Class="ThreeDModelViewerAndExporter.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:ThreeDModelViewerAndExporter"
        xmlns:helix="http://helix-toolkit.org/wpf"
        Title="3D Model Viewer and Exporter" Height="800" Width="1200"
        Background="{DynamicResource WindowBackgroundBrush}" Foreground="{DynamicResource WindowForegroundBrush}">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*" MinHeight="200"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="280" MinHeight="150"/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*" MinWidth="300"/>
            <ColumnDefinition Width="Auto"/>
            <ColumnDefinition Width="300" MinWidth="250"/>
        </Grid.ColumnDefinitions>

        <DockPanel Grid.Row="0" Grid.ColumnSpan="3" Background="{DynamicResource MenuBackgroundBrush}">
            <Menu DockPanel.Dock="Left" Background="Transparent" VerticalAlignment="Center">
                <MenuItem Header="{DynamicResource Menu_File}">
                    <MenuItem Header="{DynamicResource Menu_Load}" Click="LoadModel_Click"/>
                    <MenuItem x:Name="RecentFilesMenu" Header="{DynamicResource Menu_Recent}"/>
                    <Separator/>
                    <MenuItem Header="{DynamicResource Menu_Export}" Click="ExportModel_Click"/>
                    <MenuItem Header="{DynamicResource Menu_Exit}" Click="Exit_Click"/>
                </MenuItem>
                <MenuItem Header="{DynamicResource Menu_Edit}">
                    <MenuItem Header="{DynamicResource Menu_CenterModel}" Click="CenterModel_Click"/>
                    <MenuItem Header="{DynamicResource Menu_GenerateReport}" Click="GenerateReport_Click"/>
                </MenuItem>
                <MenuItem Header="{DynamicResource Menu_Help}">
                    <MenuItem Header="{DynamicResource Menu_About}" Click="About_Click"/>
                </MenuItem>
            </Menu>
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                <Button Content="{DynamicResource Btn_Photo}" Click="Screenshot_Click" Margin="5,2" Padding="8,2"/>
                <ToggleButton x:Name="TurntableToggle" Content="{DynamicResource Btn_Turntable}" Click="Turntable_Click" Margin="5,2" Padding="8,2"/>
                <Button x:Name="CameraModeButton" Content="{DynamicResource Btn_Perspective}" Click="ToggleCamera_Click" Margin="5,2" Padding="8,2"/>
                <Button Content="{DynamicResource Btn_BG}" Click="BGColor_Click" Margin="5,2" Padding="8,2"/>
                <Button x:Name="ThemeToggleButton" Content="ðŸŒ™" Click="ThemeToggle_Click" Width="40" Background="Transparent" BorderThickness="0" FontSize="18"/>
            </StackPanel>
        </DockPanel>

        <helix:HelixViewport3D x:Name="viewPort" Grid.Row="1" Grid.Column="0" ZoomExtentsWhenLoaded="True" Background="#1A1A1B">
            <helix:SunLight/>
            <ModelVisual3D x:Name="LightsVisual"><ModelVisual3D.Content><Model3DGroup><AmbientLight Color="#404040"/><DirectionalLight x:Name="MainDirectionalLight" Color="White" Direction="-1,-1,-1"/></Model3DGroup></ModelVisual3D.Content></ModelVisual3D>
            <helix:GridLinesVisual3D x:Name="gridLines" Width="1000" Length="1000" MinorDistance="1" MajorDistance="10" Fill="#33FFFFFF" Thickness="0.01"/>
            <helix:LinesVisual3D x:Name="boundingBoxVisual" Color="Yellow" Thickness="1"/>
            <helix:LinesVisual3D x:Name="selectionBoxVisual" Color="Cyan" Thickness="2"/>
        </helix:HelixViewport3D>

        <GridSplitter Grid.Row="1" Grid.Column="1" Width="4" Background="#333" HorizontalAlignment="Center" VerticalAlignment="Stretch"/>

        <TabControl Grid.Row="1" Grid.Column="2" Background="{DynamicResource MenuBackgroundBrush}" BorderThickness="0">
            <TabItem Header="{DynamicResource Tab_Scene}">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="10">
                        <TextBlock x:Name="ModelNameText" Text="{DynamicResource Msg_ModelNone}" FontWeight="Bold" Margin="0,0,0,10" TextWrapping="Wrap"/>
                        <Expander Header="{DynamicResource Grp_ViewAngles}" IsExpanded="True">
                            <UniformGrid Columns="3" Margin="5">
                                <Button Content="{DynamicResource Btn_Front}" Click="CamView_Click" Tag="Front" Margin="1"/><Button Content="{DynamicResource Btn_Back}" Click="CamView_Click" Tag="Back" Margin="1"/><Button Content="{DynamicResource Btn_Top}" Click="CamView_Click" Tag="Top" Margin="1"/><Button Content="{DynamicResource Btn_Bottom}" Click="CamView_Click" Tag="Bottom" Margin="1"/><Button Content="{DynamicResource Btn_Left}" Click="CamView_Click" Tag="Left" Margin="1"/><Button Content="{DynamicResource Btn_Right}" Click="CamView_Click" Tag="Right" Margin="1"/>
                            </UniformGrid>
                        </Expander>
                        <Expander Header="{DynamicResource Grp_LightGrid}" IsExpanded="True">
                            <StackPanel Margin="5">
                                <TextBlock Text="{DynamicResource Lbl_LightIntensity}"/><Slider x:Name="LightIntensitySlider" Minimum="0" Maximum="2" Value="1" ValueChanged="LightIntensity_Changed" Margin="0,5"/>
                                <CheckBox x:Name="ShowGridCheckBox" Content="{DynamicResource Chk_ShowGrid}" IsChecked="True" Checked="ShowGrid_Changed" Unchecked="ShowGrid_Changed" Margin="0,5"/>
                                <TextBlock Text="{DynamicResource Lbl_GridSpacing}"/><Slider x:Name="GridDistanceSlider" Minimum="0.1" Maximum="100" Value="1" ValueChanged="GridSettings_Changed" Margin="0,5"/>
                                <TextBlock Text="{DynamicResource Lbl_GridOpacity}"/><Slider x:Name="GridOpacitySlider" Minimum="0" Maximum="1" Value="0.5" ValueChanged="GridSettings_Changed" Margin="0,5"/>
                                <CheckBox x:Name="ShowAxisCheckBox" Content="{DynamicResource Chk_ShowAxis}" IsChecked="True" Checked="ShowAxis_Changed" Unchecked="ShowAxis_Changed" Margin="0,5"/>
                            </StackPanel>
                        </Expander>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>
            <TabItem Header="{DynamicResource Tab_Material}">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="10">
                        <TextBlock Text="{DynamicResource Lbl_MeshSettings}" FontWeight="Bold" Margin="0,0,0,10"/>
                        <TextBlock Text="{DynamicResource Lbl_Opacity}"/><Slider x:Name="OpacitySlider" Minimum="0.1" Maximum="1" Value="1" ValueChanged="Opacity_Changed" Margin="0,5"/>
                        <Button Content="{DynamicResource Btn_ChangeColor}" Click="ChangeMeshColor_Click" Margin="0,5"/>
                        <CheckBox x:Name="WireOverlayCheckBox" Content="{DynamicResource Chk_Wireframe}" Checked="RenderMode_Changed" Unchecked="RenderMode_Changed" Margin="0,5"/>
                        <TextBlock Text="{DynamicResource Lbl_Bloom}"/><Slider x:Name="BloomSlider" Minimum="0" Maximum="10" Value="0" ValueChanged="Bloom_Changed" Margin="0,5"/>
                        <CheckBox x:Name="GrayscaleCheckBox" Content="{DynamicResource Chk_Grayscale}" Checked="Effect_Changed" Unchecked="Effect_Changed" Margin="0,5"/>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>
            <TabItem Header="{DynamicResource Tab_Analysis}">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="10">
                        <ComboBox x:Name="UnitComboBox" SelectionChanged="Unit_Changed" Margin="0,5"><ComboBoxItem Content="unit"/><ComboBoxItem Content="mm"/><ComboBoxItem Content="cm"/><ComboBoxItem Content="m"/></ComboBox>
                        <TextBlock x:Name="DimXText" Text="X: 0.0" Margin="0,2"/><TextBlock x:Name="DimYText" Text="Y: 0.0" Margin="0,2"/><TextBlock x:Name="DimZText" Text="Z: 0.0" Margin="0,2"/><TextBlock x:Name="VolumeText" Text="Hacim: 0.0" Margin="0,2"/>
                        <CheckBox x:Name="ShowBBCheckBox" Content="{DynamicResource Chk_ShowBoundingBox}" Checked="BB_Changed" Unchecked="BB_Changed" Margin="0,10"/>
                        <TextBlock x:Name="PolyCountText" Text="Polys: 0" Margin="0,2"/><TextBlock x:Name="VertCountText" Text="Verts: 0" Margin="0,2"/>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>
            <TabItem Header="{DynamicResource Tab_General}">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="10">
                        <TextBlock Text="{DynamicResource Lbl_AppSettings}" FontWeight="Bold" Margin="0,0,0,10"/>
                        <CheckBox x:Name="ShowFPSCheckBox" Content="{DynamicResource Chk_ShowFPS}" IsChecked="{Binding ShowFPS}" Margin="0,5"/>
                        <TextBlock Text="{DynamicResource Lbl_Language}" Margin="0,5,0,0"/>
                        <ComboBox x:Name="LanguageComboBox" Margin="0,5" SelectionChanged="Language_Changed">
                            <ComboBoxItem Content="TÃ¼rkÃ§e" Tag="tr-TR"/><ComboBoxItem Content="English" Tag="en-US"/><ComboBoxItem Content="Deutsch" Tag="de-DE"/><ComboBoxItem Content="FranÃ§ais" Tag="fr-FR"/>
                        </ComboBox>
                        <TextBlock Text="{DynamicResource Lbl_CameraSense}" Margin="0,10,0,0"/><Slider x:Name="CameraSenseSlider" Minimum="0.1" Maximum="5" Value="1" Margin="0,5"/>
                        <Button Content="{DynamicResource Btn_SaveSettings}" Click="SaveSettings_Click" Margin="0,20" Padding="5" Background="#444" Foreground="White" FontWeight="Bold"/>
                        <Button Content="{DynamicResource Btn_ResetTransform}" Click="ResetTransform_Click" Margin="0,5" Padding="5"/>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>
        </TabControl>

        <GridSplitter Grid.Row="2" Grid.ColumnSpan="3" Height="4" Background="#333" HorizontalAlignment="Stretch" VerticalAlignment="Center"/>

        <Grid Grid.Row="3" Grid.ColumnSpan="3" Background="{DynamicResource MenuBackgroundBrush}">
            <Grid.ColumnDefinitions><ColumnDefinition Width="1.5*"/><ColumnDefinition Width="Auto"/><ColumnDefinition Width="1.2*"/><ColumnDefinition Width="Auto"/><ColumnDefinition Width="1.5*"/></Grid.ColumnDefinitions>
            <GroupBox Header="{DynamicResource Grp_MeshExplorer}" Margin="5">
                <Grid>
                    <Grid.RowDefinitions><RowDefinition Height="Auto"/><RowDefinition Height="*"/></Grid.RowDefinitions>
                    <Slider x:Name="MeshSizeSlider" Minimum="80" Maximum="250" Value="110" Margin="5"/>
                    <ListBox x:Name="MeshListBox" Grid.Row="1" Background="Transparent" BorderThickness="0" ScrollViewer.HorizontalScrollBarVisibility="Disabled" SelectionChanged="MeshListBox_SelectionChanged">
                        <ListBox.ItemsPanel><ItemsPanelTemplate><WrapPanel/></ItemsPanelTemplate></ListBox.ItemsPanel>
                        <ListBox.ItemTemplate><DataTemplate><Border BorderBrush="#444" BorderThickness="1" Margin="3" Background="#222" CornerRadius="4" Width="{Binding Value, ElementName=MeshSizeSlider}" Height="{Binding Value, ElementName=MeshSizeSlider}"><Grid><StackPanel VerticalAlignment="Center" HorizontalAlignment="Center"><TextBlock Text="ðŸ“¦" FontSize="32" HorizontalAlignment="Center"/><TextBlock Text="{Binding AssimpMesh.FaceCount, StringFormat='F: {0}'}" FontSize="9" Foreground="Gray" HorizontalAlignment="Center"/><TextBlock Text="{Binding AssimpMesh.VertexCount, StringFormat='V: {0}'}" FontSize="9" Foreground="Gray" HorizontalAlignment="Center"/></StackPanel><Button Content="ðŸ’¾" Click="QuickSaveMesh_Click" Tag="{Binding}" HorizontalAlignment="Right" VerticalAlignment="Top" Width="24" Height="24" Margin="2" Background="#AA000000" Foreground="White" BorderThickness="0"/><Border VerticalAlignment="Bottom" Background="#CC000000" Padding="3"><TextBlock Text="{Binding Name}" FontSize="9" Foreground="White" TextTrimming="CharacterEllipsis" TextAlignment="Center"/></Border></Grid></Border></DataTemplate></ListBox.ItemTemplate>
                    </ListBox>
                </Grid>
            </GroupBox>
            <GridSplitter Grid.Column="1" Width="4" Background="#333"/>
            <GroupBox Grid.Column="2" Header="{DynamicResource Grp_Preview}" Margin="5">
                <helix:HelixViewport3D x:Name="submeshPreviewPort" ZoomExtentsWhenLoaded="True" Background="#111" ShowCoordinateSystem="False" ShowViewCube="False"><helix:SunLight/><ModelVisual3D x:Name="submeshPreviewVisual"/></helix:HelixViewport3D>
            </GroupBox>
            <GridSplitter Grid.Column="3" Width="4" Background="#333"/>
            <GroupBox Grid.Column="4" Header="{DynamicResource Grp_TextureLib}" Margin="5">
                <Grid>
                    <Grid.RowDefinitions><RowDefinition Height="Auto"/><RowDefinition Height="*"/></Grid.RowDefinitions>
                    <StackPanel Orientation="Horizontal" Margin="5"><Slider x:Name="TextureSizeSlider" Minimum="60" Maximum="200" Value="90" Width="150"/><Button Content="{DynamicResource Btn_BatchExport}" Click="ExportAllTextures_Click" Margin="10,0" Padding="5,0"/></StackPanel>
                    <ListBox x:Name="TextureListBox" Grid.Row="1" Background="Transparent" BorderThickness="0" ScrollViewer.HorizontalScrollBarVisibility="Disabled" MouseDoubleClick="TextureListBox_MouseDoubleClick">
                        <ListBox.ItemsPanel><ItemsPanelTemplate><WrapPanel/></ItemsPanelTemplate></ListBox.ItemsPanel>
                        <ListBox.ItemTemplate><DataTemplate><Border BorderBrush="#444" BorderThickness="1" Margin="2" Background="#111" Width="{Binding Value, ElementName=TextureSizeSlider}" Height="{Binding Value, ElementName=TextureSizeSlider}"><Grid><Image Source="{Binding Thumbnail}" Stretch="UniformToFill"/><Button Content="ðŸ’¾" Click="QuickSaveTexture_Click" Tag="{Binding}" HorizontalAlignment="Right" VerticalAlignment="Top" Width="22" Height="22" Background="#AA000000" Foreground="White" BorderThickness="0"/><Border VerticalAlignment="Bottom" Background="#AA000000" Padding="2"><TextBlock Text="{Binding Name}" FontSize="8" Foreground="White" TextTrimming="CharacterEllipsis"/></Border></Grid></Border></DataTemplate></ListBox.ItemTemplate>
                    </ListBox>
                </Grid>
            </GroupBox>
        </Grid>
    </Grid>
</Window>